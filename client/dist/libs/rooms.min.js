function Rooms(a){"use strict";options=a}var options,transporter,messageTypes={CONNECT:"connect",MESSAGE:"message",REQUEST_NUM_OF_USERS:"numberOfUsersInRoom",STATE_CHANGE:"stateChange",GET_STATE:"getState",DBCONNECTOR:"dbconnector"},CONNECTION="connection",JOIN_ROOM="joinRoom",REGISTER="register",STORE_STATE="storeState",REQUEST_NUM_OF_USERS=messageTypes.REQUEST_NUM_OF_USERS,PRIVATE_MESSAGE="privmessage",SUBSCRIPTIONS="subscriptions",DISCONNECT="disconnect";sendMessageToLog=function(a){"use strict";options.debugMode&&console.log(a)},Rooms.prototype.sendMessage=function(a){transporter.send(a),sendMessageToLog("message to room: "+a)},Rooms.prototype.emitMessage=function(a,b){transporter.emit(a,b),sendMessageToLog("emit message to room: "+a)},Rooms.prototype.registerUser=function(a){var b={userId:a,roomName:options.roomSetup.roomName};this.emitMessage(REGISTER,b),options.userRegisteredCallBackFunction()},Rooms.prototype.storeState=function(a,b,c){var d={name:b,vo:a,userId:c};sendMessageToLog("store state "+b),this.emitMessage(STORE_STATE,d)},Rooms.prototype.getNumberOfRegisteredUsersInRoom=function(a){var b={userId:a,room:options.roomSetup.roomName};this.emitMessage(REQUEST_NUM_OF_USERS,b),sendMessageToLog("request num of users in a room to user: "+JSON.stringify(b))},Rooms.prototype.getState=function(a,b){sendMessageToLog("get state: "+b);var c={userId:a,room:options.roomSetup.roomName,stateName:b};this.emitMessage(GET_STATE,c)},Rooms.prototype.start=function(a){transporter=a,this.listenToMessages()},Rooms.prototype.callDbConnector=function(a,b,c,d){var e={userId:a,methodName:b,room:options.roomSetup.roomName,callBackMethodName:c,params:d};this.emitMessage("dbconnector",e)},Rooms.prototype.listenToMessages=function(){sendMessageToLog("listenToMessages from room: "+options.roomSetup.roomName),Object.keys(messageTypes).forEach(function(a){transporter.on(messageTypes[a],function(b){Rooms.prototype[messageTypes[a]](b)})})},Rooms.prototype[messageTypes.CONNECT]=function(){transporter.emit(JOIN_ROOM,options.roomSetup),sendMessageToLog("connect to room: "+options.roomSetup.roomName),options.userConnectedCallBackFunction()},Rooms.prototype[messageTypes.DBCONNECTOR]=function(a){sendMessageToLog("dbconnector message back, methodName: "+a.data.methodName),a.data.hasOwnProperty("callBackMethodName")&&window[a.data.callBackMethodName](a)},Rooms.prototype[messageTypes.MESSAGE]=function(a){sendMessageToLog("message from room"),null!=messageFromRoomCallBackfunction&&messageFromRoomCallBackfunction(a)},Rooms.prototype[messageTypes.REQUEST_NUM_OF_USERS]=function(a){sendMessageToLog("numberOfUsersInRoom message: "+a.size),null!=options.numOfUsersInARoomCallBackFunction&&options.numOfUsersInARoomCallBackFunction(a)},Rooms.prototype[messageTypes.GET_STATE]=function(a){sendMessageToLog("get state results: "+a.name),messageFromRoomCallBackfunction(a.vo)},Rooms.prototype[messageTypes.STATE_CHANGE]=function(a){sendMessageToLog("get state change: "+a.name),options.stateChangeCallBackFunction(a.vo)},Rooms.makeid=function(a){"use strict";var b,c="",d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(b=0;a>b;b++)c+=d.charAt(Math.floor(Math.random()*d.length));return c},"undefined"!=typeof exports&&(exports.transporter=transporter,exports.options=options,exports.CONNECTION=CONNECTION,exports.CONNECT=CONNECT,exports.MESSAGE=MESSAGE,exports.JOIN_ROOM=JOIN_ROOM,exports.REGISTER=REGISTER,exports.REQUEST_NUM_OF_USERS=REQUEST_NUM_OF_USERS,exports.STORE_STATE=STORE_STATE,exports.STATE_CHANGE=STATE_CHANGE,exports.PRIVATE_MESSAGE=PRIVATE_MESSAGE,exports.GET_STATE=GET_STATE,exports.SUBSCRIPTIONS=SUBSCRIPTIONS,exports.DISCONNECT=DISCONNECT,exports.DBCONNECTOR=DBCONNECTOR);